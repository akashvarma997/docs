openapi: "3.1.0"
info:
  title: Athena GiftCard API V3
  description: |
    The Athena GiftCard API v3 introduces support for direct game topups alongside traditional gift card vouchers.

    ## What's New in V3
    - **Fulfilment Types** - Support for both `VOUCHER` (gift cards) and `TOPUP` (direct game topups)
    - **Player ID Validation** - Validate player IDs before purchase
    - **Server/Zone Selection** - Dynamic server and zone options for topup products
    - **List Servers Endpoint** - Fetch available servers for topup SKUs
    - **Price Validation** - `final_price` field ensures price consistency

    ## Authentication
    All API requests require two headers:
    - `Authorization: Bearer <your_api_key>`
    - `partnerid: <your_partner_id>`

    Contact sunil.kumar@lysto.io for credentials and IP whitelisting.

    ## Topup Flow
    1. Get SKUs to check `fulfilment_type` and `topup_details`
    2. If TOPUP, optionally call List Servers for server options
    3. Call Validate to verify player ID
    4. Call Purchase with validated details
  version: "3.0.0"
  contact:
    name: Athena Support
    email: sunil.kumar@lysto.io

servers:
  - url: https://distapi.athenagaming.gg/api/v3
    description: Production
  - url: https://stagedistapi.lysto.io/api/v3
    description: Staging
  - url: http://localhost:3001/api/v3
    description: Local Development

security:
  - BearerAuth: []
    PartnerId: []

tags:
  - name: SKUs
    description: Get SKU details with topup support
  - name: Servers
    description: List available servers for topup products
  - name: Validation
    description: Validate purchase before execution
  - name: Purchase
    description: Purchase vouchers and topups
  - name: Orders
    description: Check order status

paths:
  /giftcards/{giftcard_id}/skus:
    get:
      tags:
        - SKUs
      summary: Get Gift Card SKU Details
      description: |
        Returns available SKUs with topup support. V3 introduces:

        - **`fulfilment_type`** - Indicates `VOUCHER` or `TOPUP`
        - **`topup_details`** - Configuration for topup products including required fields and server/zone options

        **Topup Details Fields:**
        | Field | Description |
        |-------|-------------|
        | `required_fields` | Fields that must be provided (e.g., `player_id`, `server_id`) |
        | `optional_fields` | Optional fields (e.g., `role_id`, `character_id`) |
        | `servers` | Available servers for server-based topups |
        | `zones` | Available zones for zone-based topups |
        | `roles` | Available roles |
        | `characters` | Available characters |
      operationId: getGiftCardSkus
      parameters:
        - name: giftcard_id
          in: path
          required: true
          description: Gift card product ID
          schema:
            type: string
          example: "123"
        - name: page
          in: query
          description: Page number (0-indexed)
          schema:
            type: integer
            default: 0
        - name: pageSize
          in: query
          description: Items per page (max 100)
          schema:
            type: integer
            default: 20
            maximum: 100
      responses:
        '200':
          description: Successful response with SKUs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SkusResponse'
              examples:
                voucher_skus:
                  summary: Voucher SKUs
                  value:
                    skus:
                      - sku_id: "456"
                        name: "Amazon ₹100"
                        brand: "Amazon"
                        fulfilment_type: "VOUCHER"
                        denomination: "100.00"
                        tax_rate: "18.00"
                        discount: "5.00%"
                        status: "active"
                        createdAt: 1701388800
                        updateAt: 1701388800
                      - sku_id: "457"
                        name: "Amazon ₹500"
                        brand: "Amazon"
                        fulfilment_type: "VOUCHER"
                        denomination: "500.00"
                        tax_rate: "18.00"
                        discount: "5.00%"
                        status: "active"
                        createdAt: 1701388800
                        updateAt: 1701388800
                    pagination:
                      total: 2
                      page: 0
                      pageSize: 20
                      totalPages: 1
                topup_server_based:
                  summary: Topup SKUs (Server Based)
                  value:
                    skus:
                      - sku_id: "789"
                        name: "Free Fire 100 Diamonds"
                        brand: "Free Fire"
                        fulfilment_type: "TOPUP"
                        topup_details:
                          required_fields:
                            - "player_id"
                            - "server_id"
                            - "server_name"
                          optional_fields:
                            - "role_id"
                          servers:
                            - id: "s1"
                              name: "Asia"
                            - id: "s2"
                              name: "Europe"
                            - id: "s3"
                              name: "North America"
                        denomination: "100.00"
                        tax_rate: "18.00"
                        discount: "3.00%"
                        status: "active"
                        createdAt: 1701388800
                        updateAt: 1701388800
                    pagination:
                      total: 1
                      page: 0
                      pageSize: 20
                      totalPages: 1
                topup_zone_based:
                  summary: Topup SKUs (Zone Based)
                  value:
                    skus:
                      - sku_id: "790"
                        name: "Mobile Legends 100 Diamonds"
                        brand: "Mobile Legends"
                        fulfilment_type: "TOPUP"
                        topup_details:
                          required_fields:
                            - "player_id"
                            - "zone_id"
                          optional_fields:
                            - "role_id"
                            - "character_id"
                          zones:
                            - id: "z1"
                              name: "Zone 1"
                            - id: "z2"
                              name: "Zone 2"
                          roles:
                            - id: "r1"
                              name: "Warrior"
                            - id: "r2"
                              name: "Mage"
                          characters:
                            - name: "Layla"
                            - name: "Miya"
                        denomination: "100.00"
                        tax_rate: "18.00"
                        discount: "3.00%"
                        status: "active"
                        createdAt: 1701388800
                        updateAt: 1701388800
                    pagination:
                      total: 1
                      page: 0
                      pageSize: 20
                      totalPages: 1
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

  /list-servers:
    post:
      tags:
        - Servers
      summary: List Servers for Topup Product
      description: |
        Returns available servers for a topup product. Use this endpoint to dynamically fetch server options.

        **When to use:**
        - When the SKU's `topup_details.required_fields` includes `server_id`
        - To get up-to-date server list before purchase
      operationId: listServers
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - giftcard_id
                - sku_id
              properties:
                giftcard_id:
                  type: string
                  description: Product ID
                  example: "123"
                sku_id:
                  type: string
                  description: SKU ID
                  example: "789"
            example:
              giftcard_id: "123"
              sku_id: "789"
      responses:
        '200':
          description: List of available servers
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListServersResponse'
              examples:
                with_servers:
                  summary: Servers Available
                  value:
                    servers:
                      - id: "s1"
                        name: "Asia"
                      - id: "s2"
                        name: "Europe"
                      - id: "s3"
                        name: "North America"
                no_servers:
                  summary: No Servers (Zone-based product)
                  value:
                    servers: []
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

  /giftcard/validate:
    post:
      tags:
        - Validation
      summary: Validate Purchase
      description: |
        Pre-validates a purchase request **without deducting balance or creating orders**.

        **Use cases:**
        - Validate player ID for topup products
        - Verify price calculations before purchase
        - Check inventory availability

        **Response includes:**
        - For TOPUP: `user_name` (player's in-game name) on success
        - For failed validation: `error` message
      operationId: validatePurchase
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ValidatePurchaseRequest'
            examples:
              voucher:
                summary: Validate Voucher Purchase
                value:
                  merchant_order_request_id: "ORD-2024-001"
                  giftcard_id: "123"
                  sku_id: "456"
                  quantity: 2
                  currency: "INR"
                  fulfilment_type: "VOUCHER"
                  final_price: "236.00"
              topup_server:
                summary: Validate Topup (Server Based)
                value:
                  merchant_order_request_id: "ORD-2024-002"
                  giftcard_id: "123"
                  sku_id: "789"
                  quantity: 1
                  currency: "INR"
                  fulfilment_type: "TOPUP"
                  topup_details:
                    player_id: "123456789"
                    server:
                      id: "s1"
                      name: "Asia"
                  final_price: "118.00"
              topup_zone:
                summary: Validate Topup (Zone Based)
                value:
                  merchant_order_request_id: "ORD-2024-003"
                  giftcard_id: "124"
                  sku_id: "790"
                  quantity: 1
                  currency: "INR"
                  fulfilment_type: "TOPUP"
                  topup_details:
                    player_id: "987654321"
                    zone_id: "z1"
                    role_id: "r1"
                  final_price: "118.00"
      responses:
        '200':
          description: Validation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidatePurchaseResponse'
              examples:
                voucher_success:
                  summary: Voucher Validation Success
                  value:
                    merchant_order_request_id: "ORD-2024-001"
                    status: "validated"
                    fulfilment_type: "VOUCHER"
                voucher_failed:
                  summary: Voucher Validation Failed
                  value:
                    merchant_order_request_id: "ORD-2024-001"
                    status: "failed"
                    fulfilment_type: "VOUCHER"
                    error: "Insufficient inventory for requested quantity"
                topup_success:
                  summary: Topup Validation Success
                  value:
                    merchant_order_request_id: "ORD-2024-002"
                    status: "validated"
                    fulfilment_type: "TOPUP"
                    user_name: "ProGamer2024"
                topup_failed:
                  summary: Topup Validation Failed
                  value:
                    merchant_order_request_id: "ORD-2024-002"
                    status: "failed"
                    fulfilment_type: "TOPUP"
                    error: "Invalid player ID. Please check and try again."
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /giftcard/purchase:
    post:
      tags:
        - Purchase
      summary: Purchase a Gift Card / Topup
      description: |
        Places a gift card or topup order. V3 supports both fulfilment types.

        **For VOUCHER orders:**
        - Returns encrypted gift codes
        - Supports delivery details and distribution channels

        **For TOPUP orders:**
        - Directly tops up the player's account
        - No encrypted codes returned
        - Requires validated `topup_details`

        **Important:** Always call `/giftcard/validate` first for TOPUP orders to verify the player ID.
      operationId: purchaseGiftCard
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PurchaseRequest'
            examples:
              voucher:
                summary: Purchase Voucher
                value:
                  merchant_order_request_id: "ORD-2024-001"
                  giftcard_id: "123"
                  sku_id: "456"
                  quantity: 2
                  currency: "INR"
                  fulfilment_type: "VOUCHER"
                  customerDetails:
                    name: "John Doe"
                    email: "john@example.com"
                    phone: "+919876543210"
                  deliveryDetails:
                    recipient_name: "Jane Doe"
                    recipient_email: "jane@example.com"
                    wish_message: "Happy Birthday!"
                  customerDistributionChannels:
                    - "EMAIL"
                    - "WHATSAPP"
                  final_price: "236.00"
              topup_server:
                summary: Purchase Topup (Server Based)
                value:
                  merchant_order_request_id: "ORD-2024-002"
                  giftcard_id: "123"
                  sku_id: "789"
                  quantity: 1
                  currency: "INR"
                  fulfilment_type: "TOPUP"
                  topup_details:
                    player_id: "123456789"
                    server:
                      id: "s1"
                      name: "Asia"
                  customerDetails:
                    name: "John Doe"
                    email: "john@example.com"
                    phone: "+919876543210"
                  final_price: "118.00"
              topup_zone:
                summary: Purchase Topup (Zone Based)
                value:
                  merchant_order_request_id: "ORD-2024-003"
                  giftcard_id: "124"
                  sku_id: "790"
                  quantity: 1
                  currency: "INR"
                  fulfilment_type: "TOPUP"
                  topup_details:
                    player_id: "987654321"
                    zone_id: "z1"
                    role_id: "r1"
                    character_id: "c1"
                  customerDetails:
                    name: "John Doe"
                    email: "john@example.com"
                    phone: "+919876543210"
                  final_price: "118.00"
      responses:
        '200':
          description: Purchase successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PurchaseResponse'
              examples:
                voucher_completed:
                  summary: Voucher Order Completed
                  value:
                    merchant_order_request_id: "ORD-2024-001"
                    order_id: "ATH-789012"
                    status: "completed"
                    fulfilment_type: "VOUCHER"
                    invoice_amount: "236.00"
                    encryptedgiftcodes: "a1b2c3d4e5f6g7h8i9j0..."
                    iv: "abc123def456"
                    tag: "xyz789uvw012"
                    senderName: "John Doe"
                    deliveryDetails:
                      name: "Jane Doe"
                      phoneNumber: "+919876543211"
                      email: "jane@example.com"
                    expiryDates:
                      - "2026-12-01"
                      - "2026-12-01"
                    redeemlink: "https://amazon.in/giftcards"
                topup_completed:
                  summary: Topup Order Completed
                  value:
                    merchant_order_request_id: "ORD-2024-002"
                    order_id: "ATH-789013"
                    status: "completed"
                    fulfilment_type: "TOPUP"
                    invoice_amount: "118.00"
                topup_processing:
                  summary: Topup Order Processing
                  value:
                    merchant_order_request_id: "ORD-2024-002"
                    order_id: "ATH-789013"
                    status: "processing"
                    fulfilment_type: "TOPUP"
                    invoice_amount: "118.00"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '409':
          $ref: '#/components/responses/DuplicateOrder'

  /orders:
    get:
      tags:
        - Orders
      summary: Check Order Status
      description: |
        Returns the current status of an order with support for both fulfilment types.

        Provide either `order_id` OR `merchant_order_request_id`.

        **Order Status Values:**
        - `processing` - Payment processed, awaiting fulfillment
        - `completed` - Order fulfilled successfully
        - `failed` - Order failed
      operationId: getOrderStatus
      parameters:
        - name: order_id
          in: query
          description: Internal order ID
          schema:
            type: string
          example: "ATH-789012"
        - name: merchant_order_request_id
          in: query
          description: Your order reference ID
          schema:
            type: string
          example: "ORD-2024-001"
      responses:
        '200':
          description: Order status retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderResponse'
              examples:
                voucher_completed:
                  summary: Voucher Order Completed
                  value:
                    merchant_order_request_id: "ORD-2024-001"
                    order_id: "ATH-789012"
                    status: "completed"
                    fulfilment_type: "VOUCHER"
                    invoice_amount: "236.00"
                    encryptedgiftcodes: "a1b2c3d4e5f6g7h8i9j0..."
                    iv: "abc123def456"
                    tag: "xyz789uvw012"
                    expiryDates:
                      - "2026-12-01"
                      - "2026-12-01"
                    redeemlink: "https://amazon.in/giftcards"
                voucher_processing:
                  summary: Voucher Order Processing
                  value:
                    merchant_order_request_id: "ORD-2024-001"
                    order_id: "ATH-789012"
                    status: "processing"
                    fulfilment_type: "VOUCHER"
                topup_completed:
                  summary: Topup Order Completed
                  value:
                    merchant_order_request_id: "ORD-2024-002"
                    order_id: "ATH-789013"
                    status: "completed"
                    fulfilment_type: "TOPUP"
                    invoice_amount: "118.00"
                topup_failed:
                  summary: Topup Order Failed
                  value:
                    merchant_order_request_id: "ORD-2024-002"
                    order_id: "ATH-789013"
                    status: "failed"
                    fulfilment_type: "TOPUP"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      description: API key provided by Athena
    PartnerId:
      type: apiKey
      in: header
      name: partnerid
      description: Partner ID provided by Athena

  responses:
    Unauthorized:
      description: Authentication failed
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error:
              type: authentication_error
              code: INVALID_CREDENTIALS
              message: Invalid partner ID or secret key
              trace_id: ath_v3_1761733373166_abc123
              retryable: false

    BadRequest:
      description: Invalid request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            invalid_player_id:
              summary: Invalid Player ID
              value:
                error:
                  type: invalid_request_error
                  code: INVALID_PLAYER_ID
                  message: Player ID validation failed
                  trace_id: ath_v3_1761733373166_def456
                  retryable: false
            topup_details_required:
              summary: Topup Details Required
              value:
                error:
                  type: invalid_request_error
                  code: TOPUP_DETAILS_REQUIRED
                  message: topup_details is required for TOPUP fulfilment type
                  trace_id: ath_v3_1761733373166_ghi789
                  retryable: false
            price_mismatch:
              summary: Price Mismatch
              value:
                error:
                  type: invalid_request_error
                  code: PRICE_MISMATCH
                  message: "final_price doesn't match calculated price. Expected: 236.00, Received: 200.00"
                  trace_id: ath_v3_1761733373166_jkl012
                  retryable: false
            invalid_server:
              summary: Invalid Server
              value:
                error:
                  type: invalid_request_error
                  code: INVALID_SERVER
                  message: Server ID is invalid
                  trace_id: ath_v3_1761733373166_mno345
                  retryable: false

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error:
              type: invalid_request_error
              code: ORDER_NOT_FOUND
              message: Order does not exist
              trace_id: ath_v3_1761733373166_pqr678
              retryable: false

    DuplicateOrder:
      description: Duplicate order ID
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error:
              type: invalid_request_error
              code: DUPLICATE_ORDER
              message: Order with this ID already exists
              trace_id: ath_v3_1761733373166_stu901
              retryable: false

  schemas:
    SkusResponse:
      type: object
      properties:
        skus:
          type: array
          items:
            $ref: '#/components/schemas/Sku'
        pagination:
          $ref: '#/components/schemas/Pagination'

    Sku:
      type: object
      properties:
        sku_id:
          type: string
          example: "789"
        name:
          type: string
          example: "Free Fire 100 Diamonds"
        brand:
          type: string
          example: "Free Fire"
        fulfilment_type:
          type: string
          description: |
            Product type:
            - `VOUCHER` - Traditional gift card with encrypted codes
            - `TOPUP` - Direct topup to player account
          enum:
            - VOUCHER
            - TOPUP
          example: "TOPUP"
        topup_details:
          $ref: '#/components/schemas/TopupDetailsSchema'
        denomination:
          type: string
          example: "100.00"
        tax_rate:
          type: string
          example: "18.00"
        discount:
          type: string
          example: "3.00%"
        status:
          type: string
          enum:
            - active
            - inactive
        createdAt:
          type: integer
        updateAt:
          type: integer

    TopupDetailsSchema:
      type: object
      description: Configuration for topup products (only present when fulfilment_type is TOPUP)
      properties:
        required_fields:
          type: array
          description: Fields that must be provided for purchase
          items:
            type: string
          example:
            - "player_id"
            - "server_id"
            - "server_name"
        optional_fields:
          type: array
          description: Optional fields
          items:
            type: string
          example:
            - "role_id"
        servers:
          type: array
          description: Available servers (for server-based topups)
          items:
            type: object
            properties:
              id:
                type: string
                example: "s1"
              name:
                type: string
                example: "Asia"
        zones:
          type: array
          description: Available zones (for zone-based topups)
          items:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
        roles:
          type: array
          description: Available roles
          items:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
        characters:
          type: array
          description: Available characters
          items:
            type: object
            properties:
              name:
                type: string

    ListServersResponse:
      type: object
      properties:
        servers:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                example: "s1"
              name:
                type: string
                example: "Asia"

    ValidatePurchaseRequest:
      type: object
      required:
        - merchant_order_request_id
        - giftcard_id
        - sku_id
        - quantity
        - fulfilment_type
        - final_price
      properties:
        merchant_order_request_id:
          type: string
          description: Unique order ID
          example: "ORD-2024-001"
        giftcard_id:
          type: string
          description: Product ID
          example: "123"
        sku_id:
          type: string
          description: SKU ID
          example: "789"
        quantity:
          type: integer
          description: Number of items
          minimum: 1
          example: 1
        currency:
          type: string
          default: "INR"
          example: "INR"
        fulfilment_type:
          type: string
          description: VOUCHER or TOPUP
          enum:
            - VOUCHER
            - TOPUP
          example: "TOPUP"
        topup_details:
          $ref: '#/components/schemas/TopupDetailsPurchase'
        final_price:
          type: string
          description: Expected final price for validation
          example: "118.00"

    TopupDetailsPurchase:
      type: object
      description: Topup configuration (required for TOPUP fulfilment type)
      properties:
        player_id:
          type: string
          description: Player ID (required for all topups)
          example: "123456789"
        server:
          type: object
          description: Server selection (if server_id in required_fields)
          properties:
            id:
              type: string
              example: "s1"
            name:
              type: string
              example: "Asia"
        zone_id:
          type: string
          description: Zone ID (if zone_id in required_fields)
          example: "z1"
        role_id:
          type: string
          description: Role ID (optional)
          example: "r1"
        character_id:
          type: string
          description: Character ID (optional)
          example: "c1"

    ValidatePurchaseResponse:
      type: object
      properties:
        merchant_order_request_id:
          type: string
        status:
          type: string
          description: Validation result
          enum:
            - validated
            - failed
        fulfilment_type:
          type: string
          enum:
            - VOUCHER
            - TOPUP
        user_name:
          type: string
          description: Player's in-game name (for TOPUP validation success)
          example: "ProGamer2024"
        error:
          type: string
          description: Error message (for validation failure)

    PurchaseRequest:
      type: object
      required:
        - merchant_order_request_id
        - giftcard_id
        - sku_id
        - quantity
        - fulfilment_type
        - final_price
      properties:
        merchant_order_request_id:
          type: string
          description: Unique order ID / idempotency key
          example: "ORD-2024-001"
        giftcard_id:
          type: string
          example: "123"
        sku_id:
          type: string
          example: "456"
        quantity:
          type: integer
          minimum: 1
          example: 2
        currency:
          type: string
          default: "INR"
        fulfilment_type:
          type: string
          enum:
            - VOUCHER
            - TOPUP
        topup_details:
          $ref: '#/components/schemas/TopupDetailsPurchase'
        customerDetails:
          $ref: '#/components/schemas/CustomerDetails'
        deliveryDetails:
          $ref: '#/components/schemas/DeliveryDetails'
        customerDistributionChannels:
          type: array
          description: Delivery methods (VOUCHER only)
          items:
            type: string
            enum:
              - EMAIL
              - WHATSAPP
              - SMS
        final_price:
          type: string
          description: Expected final price
          example: "236.00"

    CustomerDetails:
      type: object
      properties:
        name:
          type: string
          example: "John Doe"
        email:
          type: string
          format: email
          example: "john@example.com"
        phone:
          type: string
          pattern: '^\+91[0-9]{10}$'
          example: "+919876543210"
        address:
          $ref: '#/components/schemas/Address'

    Address:
      type: object
      properties:
        line1:
          type: string
        line2:
          type: string
        city:
          type: string
        state:
          type: string
        postal_code:
          type: string
        country:
          type: string
          default: "India"

    DeliveryDetails:
      type: object
      description: Recipient info (VOUCHER only)
      properties:
        recipient_name:
          type: string
        recipient_email:
          type: string
          format: email
        recipient_phone:
          type: string
        wish_message:
          type: string
          maxLength: 500

    PurchaseResponse:
      type: object
      properties:
        merchant_order_request_id:
          type: string
        order_id:
          type: string
          example: "ATH-789012"
        status:
          type: string
          enum:
            - completed
            - processing
            - failed
        fulfilment_type:
          type: string
          enum:
            - VOUCHER
            - TOPUP
        invoice_amount:
          type: string
          description: Calculated invoice amount
          example: "236.00"
        encryptedgiftcodes:
          type: string
          description: Encrypted gift codes (VOUCHER only)
        iv:
          type: string
        tag:
          type: string
        senderName:
          type: string
        deliveryDetails:
          type: object
          properties:
            name:
              type: string
            phoneNumber:
              type: string
            email:
              type: string
        expiryDates:
          type: array
          description: Gift card expiry dates (VOUCHER only)
          items:
            type: string
        redeemlink:
          type: string
          format: uri

    OrderResponse:
      type: object
      properties:
        merchant_order_request_id:
          type: string
        order_id:
          type: string
        status:
          type: string
          enum:
            - completed
            - processing
            - failed
        fulfilment_type:
          type: string
          enum:
            - VOUCHER
            - TOPUP
        invoice_amount:
          type: string
        encryptedgiftcodes:
          type: string
          description: Only for VOUCHER orders
        iv:
          type: string
        tag:
          type: string
        expiryDates:
          type: array
          items:
            type: string
        redeemlink:
          type: string
          format: uri

    Pagination:
      type: object
      properties:
        total:
          type: integer
          example: 10
        page:
          type: integer
          example: 0
        pageSize:
          type: integer
          example: 20
        totalPages:
          type: integer
          example: 1

    ErrorResponse:
      type: object
      properties:
        error:
          type: object
          properties:
            type:
              type: string
              enum:
                - authentication_error
                - invalid_request_error
                - api_error
            code:
              type: string
              description: |
                V3-specific error codes:
                - `INVALID_PLAYER_ID` - Player ID validation failed
                - `INVALID_SERVER` - Server ID is invalid
                - `TOPUP_VALIDATION_FAILED` - Topup validation failed
                - `TOPUP_DETAILS_REQUIRED` - topup_details missing for TOPUP
                - `CURRENCY_MISMATCH` - Currency doesn't match SKU
                - `PRICE_MISMATCH` - final_price doesn't match calculated price
            message:
              type: string
            trace_id:
              type: string
            retryable:
              type: boolean
            fields:
              type: array
              items:
                type: object
                properties:
                  param:
                    type: string
                  code:
                    type: string
                  message:
                    type: string
            meta:
              type: object
              additionalProperties: true
